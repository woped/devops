name: Linting

on:
  workflow_call:

jobs:
  build:
    name: Lint Code Base
    runs-on: ubuntu-latest

    steps:

      - name: Checkout Code
        uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Download checkstyle.xml from devops repo
        run: |
          mkdir -p .github/linter-configurations
          curl -sSL https://raw.githubusercontent.com/woped/devops/main/.github/linter-configurations/checkstyle.xml -o .github/linter-configurations/checkstyle.xml

      - name: Lint Code Base
        uses: github/super-linter@v4
        env: 
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          VALIDATE_ALL_CODEBASE: false
          
          # Disable overly strict linters
          VALIDATE_MARKDOWN: false
          VALIDATE_NATURAL_LANGUAGE: false
          VALIDATE_JSCPD: false                                 # Disable copy-paste detection
          VALIDATE_EDITORCONFIG: false                          # Disable editorconfig validation
          VALIDATE_GOOGLE_JAVA_FORMAT: false                    # Disable strict Google Java formatting
          VALIDATE_CSS: false                                   # Disable CSS linting
          VALIDATE_HTML: false                                  # Disable HTML linting
          VALIDATE_JSON: false                                  # Disable JSON linting (often too strict)
          VALIDATE_XML: false                                   # Disable XML linting
          VALIDATE_YAML: false                                  # Disable YAML linting (often too strict)
          VALIDATE_BASH: false                                  # Disable shell script linting
          VALIDATE_SHELL_SHFMT: false                           # Disable shell formatting
          VALIDATE_DOCKERFILE_HADOLINT: false                   # Disable Dockerfile linting
          
          # Keep Java validation with relaxed checkstyle config
          LINTER_RULES_PATH: /.github/linter-configurations/
          JAVA_FILE_NAME: checkstyle.xml
          
          # Don't fail on warnings
          DISABLE_ERRORS: false
          LOG_LEVEL: WARN              